# Plan for Remarkpy MVP 1.0

This document outlines the steps to develop Remarkpy to its Minimum Viable Product (MVP) 1.0 stage. The goal is to create a usable, documented, and well-structured Python library that interfaces with JavaScript's RemarkJS ecosystem for Markdown processing.

## 1. Understand Project Structure and Goals (Completed)
*   Analyze `llms.txt` (Repomix output) to understand the current state of the `remarkpy` project.
*   Define MVP 1.0: A usable, documented, and well-structured Python library that interfaces with JavaScript's RemarkJS ecosystem (specifically `md-mdast`) for Markdown processing using `quickjs`.

## 2. Create Core Documentation Files (Current)
*   **`PLAN.md`**: This document.
*   **`TODO.md`**: A linearized, itemized checklist derived from `PLAN.md` for tracking progress.
*   **`CHANGELOG.md`**: To record all significant changes made during development. Initialize with an "Unreleased" section.

## 3. Refine Python Interface
*   **Rename `remarkpy/test.py`**: Choose a more descriptive name like `remarkpy/api.py` or `remarkpy/core.py`.
*   **Develop Python API**:
    *   Create a primary class (e.g., `RemarkpyParser`) or a set of functions for parsing Markdown.
    *   The API should accept a Markdown string and return the MDAST structure (likely as Python dictionaries/lists).
    *   Implement clear error handling (e.g., for JavaScript execution errors or invalid input).
    *   Ensure the Python code correctly loads and interacts with the bundled JavaScript (`remarkpy/remarkpy.js`) using `quickjs`.
*   **Add Example Usage**: Provide a clear example in the docstring or a separate examples folder.

## 4. JavaScript Bundling and Interface (`remarkpyjs/` directory)
*   **Review `remarkpyjs/index.js`**: Ensure it cleanly exports the `parseMd` function.
*   **Consolidate Bundler**:
    *   The `package.json` lists both `browserify` and `webpack` scripts.
    *   `webpack.config.js` is present and seems to be the more modern/configured choice.
    *   Decision: Standardize on Webpack. Remove the `browserify` script from `package.json` if it's redundant.
*   **Verify `remarkpy/remarkpy.js`**:
    *   Confirm the UMD bundle generated by Webpack is suitable for `quickjs`.
    *   Ensure `parseMd` is correctly exposed and callable.
*   **Optimize Webpack Configuration (`remarkpyjs/webpack.config.js`)**:
    *   Review for any potential improvements (e.g., source maps for easier debugging if needed, though perhaps not critical for the Python-embedded JS).
    *   Ensure `mode: 'production'` is appropriate for the distributed JS.

## 5. Testing
*   **Python Tests**:
    *   Create a `tests/` directory at the project root.
    *   Implement Python tests using `unittest` or `pytest` (decision: `pytest` for its conciseness and features).
    *   Test cases should cover:
        *   Basic Markdown syntax elements (headings, lists, bold, italic, code, etc.).
        *   Edge cases and invalid Markdown.
        *   Correct parsing of `remarkpy/test.md`.
        *   Error handling of the Python API.
*   **JavaScript Tests (Optional for MVP, but good for JS module health)**:
    *   Consider basic tests for `remarkpyjs/index.js` if complexity grows. For now, Python integration tests will cover `parseMd` functionality.

## 6. Build Process and Tooling
*   **Python Packaging**:
    *   Create `pyproject.toml` for modern Python packaging.
    *   Use a build backend like `setuptools` or `flit`. (Decision: `setuptools` with `setup.cfg` or directly in `pyproject.toml` for simplicity).
    *   Define package metadata (name, version, author, description, dependencies like `quickjs`).
    *   Ensure `remarkpy/remarkpy.js` is included as package data.
*   **`Makefile` or `justfile` (Optional)**: For common development tasks (e.g., building JS, running tests, linting).

## 7. Documentation
*   **`README.md`**:
    *   Update with a clear project description.
    *   Provide installation instructions (e.g., `pip install remarkpy`).
    *   Include comprehensive usage examples of the Python API.
    *   Explain how to run tests.
    *   Briefly mention how it works (Python + JS bridge).
*   **API Documentation**:
    *   Write clear docstrings for all public Python classes and functions.
    *   Consider generating HTML documentation using Sphinx if the API becomes complex (post-MVP).
*   **JavaScript Code Comments**: Add comments to `remarkpyjs/index.js` if any parts are non-obvious.

## 8. Code Quality and Structure
*   **Refactor**: Improve code for clarity, efficiency, and maintainability in both Python and JavaScript.
*   **Linting/Formatting**:
    *   Python: Black, Flake8. Configure in `pyproject.toml`.
    *   JavaScript: Prettier, ESLint. Configure in `remarkpyjs/package.json` and config files.
*   **File/Directory Structure**:
    *   `remarkpy/`: Python package source.
        *   `api.py` (or chosen name for main Python logic)
        *   `remarkpy.js` (bundled JS)
        *   `__init__.py`
    *   `remarkpyjs/`: JavaScript source and build tools.
    *   `tests/`: Python tests.
    *   Project root: `README.md`, `LICENSE`, `CHANGELOG.md`, `PLAN.md`, `TODO.md`, `pyproject.toml`, `.gitignore`.

## 9. Dependency Management
*   **JavaScript (`remarkpyjs/package.json`)**:
    *   Review `md-mdast` version. Update if necessary and safe.
    *   Ensure dev dependencies (`webpack`, `babel`, etc.) are appropriate.
*   **Python (`pyproject.toml`)**:
    *   Specify `quickjs` version.
    *   Specify `pytest` for testing.

## 10. Final Review and Versioning
*   Thoroughly test the entire application.
*   Update `CHANGELOG.md` with all changes for version 1.0.0.
*   Set version to `1.0.0` in `pyproject.toml` (and potentially `remarkpy/__init__.py`).
*   Tag the release in Git (e.g., `v1.0.0`).

## 11. Iterative Implementation
*   This `PLAN.md` will be updated with more granular details or adjustments as needed.
*   `TODO.md` will be marked off as tasks are completed.
*   `CHANGELOG.md` will be updated with every significant change.
*   Commit changes regularly with descriptive messages.
